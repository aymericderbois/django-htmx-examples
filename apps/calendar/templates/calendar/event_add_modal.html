<div
  class="modal-dialog"
  hx-on:htmx:load="flatpickr('.datepicker', {enableTime: true, dateFormat: 'Y-m-d H:i', time_24hr: true})"
  x-data="{
    isSaving: false,
    isDeleting: false
  }"
>
  <div class="modal-content">

    <div class="modal-header">
      <h5 class="modal-title">
        {% if form.instance.pk %}
          Edit : {{ form.instance.name }}
        {% else %}
          New event
        {% endif %}
      </h5>
      <button class="btn-close" data-bs-dismiss="modal" aria-label='Close' type="button"></button>
    </div>

    <div class="modal-body">
      <form
        id="event-add-modal-form"
        hx-post="{{ form_url }}"
        hx-target="closest .modal-dialog"
        hx-swap="outerHTML"
        @htmx:before-request="isSaving=true"
      >{% csrf_token %}
        {{ form }}
      </form>
    </div>

    <div class="modal-footer">
      {% if form.instance.pk %}
        <button
          hx-get="{% url "calendar:event_delete_modal" pk=form.instance.pk %}"
          hx-target="closest .modal-dialog"
          hx-swap="outerHTML"
          @htmx:before-request="isDeleting=true"
          class="btn btn-warning"
        >
          <span x-show="!isDeleting">Delete</span>
          <span x-show="isDeleting" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
        </button>
      {% endif %}
      <button class="btn btn-secondary" data-bs-dismiss="modal" type="button">Close</button>
      <button
        class="btn btn-primary"
        type="submit"
        form="event-add-modal-form"
      >
          <span x-show="!isSaving">Save changes</span>
          <span x-show="isSaving" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
      </button>
    </div>
  </div>
</div>
